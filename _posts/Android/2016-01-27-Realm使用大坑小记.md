---
layout:         post
title:          Realm使用大坑小记
description:    由于Realm数据库还没有到1.0,处于高速迭代更新的阶段, 使用过程中碰到各种问题, 便记下
tags:           Android
keywords:       Android
noToc: 			  true
---

#Realm.refresh();
在一个线程中保存数据, `紧接着`在另一个线程中查询他, 
此时在查询的时候需要调用`realm.refresh();`来刷新数据
我的理解是一个线程中保存数据的时候数据库中存在缓存, realm感觉是以线程为单位做事的, 所以这个时候在另一个线程中查询的时候就会查不到数据

```
public static RealmResults<CrmReportZGSum> findAll(){
        Realm realm = Realm.getDefaultInstance();
        realm.refresh(); // <<===添加了才能查到
        RealmResults<CrmReportZGSum> zgSums = null;
        try {
            zgSums = realm.where(CrmReportZGSum.class).findAll();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
//            realm.close();
        }

        return zgSums;
    }
```

#Realm.close();
像上面的代码, 如果在finally中将realm Close掉, 返回的`RealmResults`对象将不可用, 会报数据库已经被关闭的错误. 
情景2. findAllAsync调用后close掉, 还能查到数据,代码参考业绩面板业代列表


