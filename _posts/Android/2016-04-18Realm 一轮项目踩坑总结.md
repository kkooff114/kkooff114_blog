---
layout:         post
title:          Realm 一轮项目踩坑总结
description:    使用Realm做了一个项目之后的踩坑总结
tags:           Android
keywords:       Android
noToc: 			  true
---


#大坑1: realm实例
通过`realm = Realm.getDefaultInstance();`就能`创建`一个当前线程的实例, 
记住: 一定要`realm.close()`, 不然会包: 

```
io.realm.exceptions.RealmError
Unrecoverable error. mmap() failed: Out of memory size: 201326592 offset: 0 in io_realm_internal_SharedGroup.cpp line 113
```

解决方案:
合理使用`realm = Realm.getDefaultInstance();`
###1. activity中
	在全局定义
	
```java
private Realm realm;
```
在`onCreate`中创建realm实例

```java
realm = Realm.getDefaultInstance();
```

在`onDestroy`中close

```java
realm.close();
```
	
	

###2. fragment中
在全局定义

```java
private Realm realm;
```
在`onStart`中创建realm实例

```java
@Override
    public void onStart() {
        super.onStart();
        // Create Realm instance for the UI thread
        realm = Realm.getDefaultInstance();
    }
```
在`onStop`中关闭realm实例

```java
@Override
    public void onStop() {
        super.onStop();
        // Remember to close the Realm instance when done with it.
        realm.close();
    }
```



